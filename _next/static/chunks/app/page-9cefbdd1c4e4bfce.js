(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{317:function(e,t,n){Promise.resolve().then(n.bind(n,5146)),Promise.resolve().then(n.bind(n,5892))},5146:function(e,t,n){"use strict";n.d(t,{MainArea:function(){return F}});var r=n(7437),l=n(2265),a=n(6015);let i="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat("3.11.174"),o=new Map,s=new Map;function d(e){let t=s.get(e);if(t)return t;let n=new Promise((t,n)=>{let r=document.createElement("script");r.src=e,r.async=!0,r.onload=()=>t(),r.onerror=()=>n(Error("Failed to load ".concat(e))),document.head.appendChild(r)});return s.set(e,n),n}async function c(e,t){let n="/api/simbrief/ofp-proxy?url=".concat(encodeURIComponent(e),"&cv=").concat(encodeURIComponent(t)),r="".concat(e,"::").concat(t),l=o.get(r);if(l)return await l.arrayBuffer();let a=await fetch(n,{cache:"no-store",redirect:"follow"});if(!a.ok)throw Error("HTTP ".concat(a.status));let i=await a.arrayBuffer();try{let e=a.headers.get("Content-Type")||"application/pdf";o.set(r,new Blob([i],{type:e}))}catch(e){}return i}function u(e){let{src:t,zoom:n=1,className:a,style:o}=e,s=(0,l.useRef)(null),[u,m]=(0,l.useState)(null),[h,p]=(0,l.useState)(!1),x=(0,l.useRef)(null),f=(0,l.useRef)(null),b=(0,l.useMemo)(()=>{let e=t.match(/([^/]+\.pdf)(?:\?|$)/i);return e?e[1]:String(Date.now())},[t]);return(0,l.useEffect)(()=>{let e=!0;return(async()=>{try{if(await d("".concat(i,"/pdf.min.js")),!e)return;let t=window.pdfjsLib;t&&t.GlobalWorkerOptions&&(t.GlobalWorkerOptions.workerSrc="".concat(i,"/pdf.worker.min.js"))}catch(e){console.error(e)}})(),()=>{e=!1}},[]),(0,l.useEffect)(()=>{let e=!1,r=null;return async function(){if(t&&s.current){p(!0),m(null),f.current&&(f.current(),f.current=null),s.current.innerHTML="";try{await d("".concat(i,"/pdf.min.js"));let l=window.pdfjsLib;if(!l)throw Error("pdf.js failed to load.");let a=await c(t,b);if(e)return;let o=new Uint8Array(a.slice(0)),u=l.getDocument({data:o});if(r=await u.promise,e||!s.current)return;let m=[],h=[];for(let t=1;t<=r.numPages;t++){let n=await r.getPage(t);if(e)return;let l=document.createElement("div");l.style.display="flex",l.style.justifyContent="center",l.style.marginBottom="1.5rem";let a=document.createElement("canvas");a.style.maxWidth="100%",a.style.height="auto",m.push(a),h.push({page:n,canvas:a}),l.appendChild(a),s.current.appendChild(l)}let p=async()=>{if(!s.current)return;let e=Math.min(1100,s.current.clientWidth-32),t=Math.max(100,Math.floor(e*(n||1)));for(let{page:e,canvas:n}of h){let r=e.getViewport({scale:1}),l=t/r.width,a=e.getViewport({scale:l}),i=n.getContext("2d");i&&(n.width=Math.floor(a.width),n.height=Math.floor(a.height),await e.render({canvas:n,canvasContext:i,viewport:a}).promise)}};await p(),x.current&&x.current.disconnect(),x.current=new ResizeObserver(()=>{p()}),x.current.observe(s.current),f.current=()=>{x.current&&x.current.disconnect(),h.length=0,m.forEach(e=>{let t=e.getContext("2d");t&&t.clearRect(0,0,e.width,e.height)}),s.current&&(s.current.innerHTML="");try{var e,t;null==r||null===(e=r.cleanup)||void 0===e||e.call(r),null==r||null===(t=r.destroy)||void 0===t||t.call(r)}catch(e){}}}catch(t){e||m((null==t?void 0:t.message)||String(t))}finally{e||p(!1)}}}(),()=>{e=!0,f.current&&(f.current(),f.current=null)}},[t,n,b]),(0,r.jsxs)("div",{className:a,style:o,children:[h&&(0,r.jsx)("div",{className:"px-3 pb-2 text-sm",children:"Loading PDF…"}),u&&(0,r.jsxs)("div",{className:"px-3 pb-2 text-sm text-red-500",children:["PDF error: ",u]}),(0,r.jsx)("div",{ref:s,className:"w-full"})]})}let m=e=>{let t=(null!=e?e:"").trim();return t.length?t:null};function h(e){var t;let{label:n,value:l}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-start gap-1 min-w-[8ch]",children:[(0,r.jsx)("span",{className:"text-[10px] uppercase tracking-wide opacity-60",children:n}),(0,r.jsx)("span",{className:"text-sm font-medium",children:null!==(t=m(l))&&void 0!==t?t:"—"})]})}function p(e){let{data:t,title:n,suffix:l=""}=e,a=(t&&t.length?t:[0]).slice(-10),i=Math.min(...a),o=Math.max(...a)-i||1,s=a.map((e,t)=>{let n=t/(a.length-1||1)*100;return"".concat(n,",").concat(100-(e-i)/o*100)}).join(" "),d=a[a.length-1];return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{viewBox:"0 0 100 100",className:"w-24 h-8",children:(0,r.jsx)("polyline",{points:s,fill:"none",stroke:"currentColor",strokeWidth:"2",className:"opacity-70"})}),(0,r.jsxs)("div",{className:"text-xs",children:[(0,r.jsx)("div",{className:"opacity-60",children:n}),(0,r.jsxs)("div",{className:"font-medium",children:[Math.round(d),l]})]})]})}function x(e){var t,n,a,i,o,s,d,c,u,x,f,b,v,g;let{data:y,loading:w,error:N,vatsim:j,className:k}=e,S=l.useMemo(()=>{var e,t,n,r,l,a,i,o,s;return y?(null==j?void 0:j.online)?{...y,origin:null!==(e=j.origin)&&void 0!==e?e:y.origin,destination:null!==(t=j.destination)&&void 0!==t?t:y.destination,callsign:null!==(r=null!==(n=m(j.callsign))&&void 0!==n?n:y.callsign)&&void 0!==r?r:null,route:null!==(a=null!==(l=m(j.route))&&void 0!==l?l:y.route)&&void 0!==a?a:null,alternate:null!==(o=null!==(i=j.alternateIcao)&&void 0!==i?i:y.alternate)&&void 0!==o?o:null,cruiseAlt:null!=j.cruiseAltFt?"".concat(Math.round(j.cruiseAltFt)," ft"):null!==(s=y.cruiseAlt)&&void 0!==s?s:null}:y:null},[y,j]),T=null==S?void 0:S.origin,C=null==S?void 0:S.destination,E=(null==j?void 0:j.flownNm)!=null&&(null==S?void 0:S.plannedDistanceNm)&&S.plannedDistanceNm>0?Math.max(0,Math.min(100,Math.round(j.flownNm/S.plannedDistanceNm*100))):0,A=(null==j?void 0:j.online)?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-500/20 dark:text-red-400",O=(null==j?void 0:j.phase)==="ground"?"On ground":(null==j?void 0:j.phase)==="climb"?"Climbing":(null==j?void 0:j.phase)==="descent"?"Descending":(null==j?void 0:j.phase)==="cruise"?"Cruising":"";return(0,r.jsxs)("div",{className:["rounded-xl border p-4 w-full shadow-lg","bg-white text-neutral-900 border-neutral-200","dark:bg-neutral-900 dark:text-neutral-100 dark:border-neutral-800",k||""].join(" "),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-extrabold leading-none",children:null!==(a=null==T?void 0:T.icao)&&void 0!==a?a:"----"}),(0,r.jsx)("div",{className:"text-[11px] opacity-70",children:null!==(i=null==T?void 0:T.name)&&void 0!==i?i:""})]}),(0,r.jsxs)("div",{className:"flex-1 mx-3 flex items-center pt-2",children:[(0,r.jsx)("div",{className:"h-px flex-1 border-t border-dashed border-neutral-300 dark:border-neutral-600"}),(0,r.jsx)("svg",{viewBox:"0 0 20 20",className:"mx-2 w-5 h-5 rotate-90 fill-sky-600 dark:fill-sky-400","aria-hidden":!0,children:(0,r.jsx)("path",{d:"M10 0l2 8h6l-8 4 2 8-4-6-8 2 6-4-6-4 8 2z"})}),(0,r.jsx)("div",{className:"h-px flex-1 border-t border-dashed border-neutral-300 dark:border-neutral-600"})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-2xl font-extrabold leading-none",children:null!==(o=null==C?void 0:C.icao)&&void 0!==o?o:"----"}),(0,r.jsx)("div",{className:"text-[11px] opacity-70",children:null!==(s=null==C?void 0:C.name)&&void 0!==s?s:""})]})]}),(null==j?void 0:j.online)&&(j.pilotName||j.airline)&&(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs opacity-80 mb-2",children:[(0,r.jsxs)("span",{children:[j.pilotName?j.pilotName:"",j.pilotCid?" • ".concat(j.pilotCid):""]}),(0,r.jsx)("span",{children:j.airline||""})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs opacity-80 mb-3",children:[(0,r.jsx)("span",{children:null!==(d=null==S?void 0:S.schedOut)&&void 0!==d?d:"—"}),(0,r.jsxs)("div",{className:["px-2 py-0.5 rounded-full font-medium transition-colors",A].join(" "),title:(null==j?void 0:j.online)?"Pilot online on VATSIM":"Not online on VATSIM",children:["VATSIM ",(null==j?void 0:j.online)?"Online":"Offline"]}),(0,r.jsx)("span",{children:null!==(c=null==S?void 0:S.schedIn)&&void 0!==c?c:"—"})]}),(null==j?void 0:j.online)&&(0,r.jsxs)("div",{className:"mb-2 text-xs opacity-80",children:[(0,r.jsx)("span",{className:"font-medium",children:O}),"number"==typeof j.remainingNm&&(null==S?void 0:S.plannedDistanceNm)!=null?(0,r.jsxs)(r.Fragment,{children:[" • ",Math.max(0,Math.round(j.remainingNm))," / ",Math.round(S.plannedDistanceNm)," NM",j.etaText?" • ETA ".concat(j.etaText):""]}):null]}),(null==j?void 0:j.online)&&(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsx)("div",{className:"h-2 rounded bg-neutral-200 dark:bg-neutral-800 overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-sky-600 dark:bg-sky-500",style:{width:"".concat(E,"%")}})})}),(0,r.jsxs)("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-4 py-3 border-y border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)(h,{label:"GS",value:(null==j?void 0:j.online)&&(null==j?void 0:j.groundspeed)!=null?"".concat(Math.round(j.groundspeed)," kts"):"—"}),(0,r.jsx)(h,{label:"Altitude",value:(null==j?void 0:j.online)&&(null==j?void 0:j.altitudeFt)!=null?"".concat(Math.round(j.altitudeFt)," ft"):(null==S?void 0:S.cruiseAlt)||"—"}),(0,r.jsx)(h,{label:"Heading",value:(null==j?void 0:j.online)&&(null==j?void 0:j.headingDeg)!=null?"".concat(Math.round(j.headingDeg),"\xb0"):"—"}),(0,r.jsx)(h,{label:"Squawk",value:(null==j?void 0:j.online)&&null!==(u=null==j?void 0:j.squawk)&&void 0!==u?u:"—"}),(0,r.jsx)(h,{label:"COM",value:(null==j?void 0:j.online)&&null!==(x=null==j?void 0:j.com)&&void 0!==x?x:"—"}),(0,r.jsx)(h,{label:"Callsign",value:null!==(f=m(null==S?void 0:S.callsign))&&void 0!==f?f:"—"})]}),(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("div",{className:"text-[10px] uppercase tracking-wide opacity-60 mb-1",children:"Route (VATSIM overrides when online)"}),(0,r.jsx)("div",{className:"text-sm font-mono whitespace-pre-wrap break-words leading-relaxed",children:null!==(b=m(null==S?void 0:S.route))&&void 0!==b?b:"—"}),(0,r.jsxs)("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[(0,r.jsx)(h,{label:"Aircraft",value:null!==(v=null==j?void 0:j.aircraft)&&void 0!==v?v:"—"}),(0,r.jsx)(h,{label:"TAS",value:(null==j?void 0:j.tasKts)!=null?"".concat(Math.round(j.tasKts)," kts"):"—"}),(0,r.jsx)(h,{label:"Cruise Alt",value:(null==j?void 0:j.cruiseAltFt)!=null?"".concat(Math.round(j.cruiseAltFt)," ft"):null==S?void 0:S.cruiseAlt}),(0,r.jsx)(h,{label:"Alternate",value:null!==(g=null==j?void 0:j.alternateIcao)&&void 0!==g?g:null==S?void 0:S.alternate}),(0,r.jsx)(h,{label:"Planned Distance",value:(null==S?void 0:S.plannedDistanceNm)!=null?"".concat(Math.round(S.plannedDistanceNm)," NM"):"—"}),(0,r.jsx)(h,{label:"Planned ETE",value:null==S?void 0:S.plannedEte})]})]}),(null==j?void 0:j.online)&&((null===(t=j.gsHistory)||void 0===t?void 0:t.length)||(null===(n=j.altHistory)||void 0===n?void 0:n.length))?(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsx)(p,{data:j.gsHistory,title:"Groundspeed",suffix:" kts"}),(0,r.jsx)(p,{data:j.altHistory,title:"Altitude",suffix:" ft"})]}):null,w&&(0,r.jsx)("div",{className:"mt-3 text-xs opacity-70",children:"Loading latest flight…"}),N&&(0,r.jsx)("div",{className:"mt-3 text-xs text-red-600 dark:text-red-400",children:N})]})}var f=n(5450);let b={GENRUN_X1:0,GENRUN_X2:3,CLOSED_X1:8,CLOSED_X2:11,CLOSED_SSB:30};function v(e,t){let n=1===t?b.GENRUN_X1:b.GENRUN_X2,r=1===t?b.CLOSED_X1:b.CLOSED_X2,l=(e&1<<n)!=0,a=(e&1<<r)!=0;return l||a?l&&!a?"avail":"connected":"notavail"}function g(){let[e,t]=(0,l.useState)("127.0.0.1"),[n,a]=(0,l.useState)(10747),[i,o]=(0,l.useState)("checking"),[s,d]=(0,l.useState)(!1),[c,u]=(0,l.useState)(""),[m,h]=(0,l.useState)(0),[p,x]=(0,l.useState)(!1),[g,y]=(0,l.useState)(""),[w,N]=(0,l.useState)(""),[j,k]=(0,l.useState)(""),[S,T]=(0,l.useState)("notavail"),[C,E]=(0,l.useState)("notavail"),[A,O]=(0,l.useState)("closed"),[R,P]=(0,l.useState)(!1),[M,I]=(0,l.useState)(!1),F=(0,l.useCallback)(async()=>{o("checking");try{let t=await fetch("/api/psx/ping?host=".concat(encodeURIComponent(e),"&port=").concat(encodeURIComponent(String(n))),{cache:"no-store"}),r=await t.json();o((null==r?void 0:r.ok)?"up":"down")}catch(e){o("down")}},[e,n]);async function L(){try{var e,t;d(!0),u("");let n=(0,f.ri)();if(!n.simbriefUsername){u("Set SimBrief username in Settings");return}let r=await fetch("/api/simbrief/summary?username=".concat(encodeURIComponent(n.simbriefUsername)),{cache:"no-store"}),l=await r.json(),a=((null==l?void 0:l.zfw)||"").toString(),i=((null==l?void 0:l.plannedFuel)||"").toString(),o=Math.round(parseInt((null===(e=a.match(/\d+/))||void 0===e?void 0:e[0])||"",10)),s=Math.round(parseInt((null===(t=i.match(/\d+/))||void 0===t?void 0:t[0])||"",10));if(!Number.isFinite(o)||o<=0){u("Could not parse ZFW from SimBrief");return}if(!Number.isFinite(s)||s<=0){u("Could not parse Fuel from SimBrief");return}if(s>25e4){u("Fuel from SimBrief looks too high (max 250000 kg)");return}y(String(o)),N(String(s));let[c,m]=await Promise.all([fetch("/api/psx/wb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({zfwKg:o})}),fetch("/api/psx/fuel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"total",totalKg:s})})]),h=await c.json().catch(()=>({})),p=await m.json().catch(()=>({}));(null==h?void 0:h.ok)&&(null==p?void 0:p.ok)?u("Loaded from SimBrief and sent to PSX (ZFW ".concat(o.toLocaleString("en-US")," kg, Fuel ").concat(s.toLocaleString("en-US")," kg)")):(null==h?void 0:h.ok)||(null==p?void 0:p.ok)?(null==h?void 0:h.ok)?u("Fuel send failed: ".concat((null==p?void 0:p.error)||"HTTP ".concat(m.status))):u("ZFW send failed: ".concat((null==h?void 0:h.error)||"HTTP ".concat(c.status))):u("Error sending to PSX: ZFW → ".concat((null==h?void 0:h.error)||"HTTP ".concat(c.status),", Fuel → ").concat((null==p?void 0:p.error)||"HTTP ".concat(m.status)))}catch(e){u("Error loading from SimBrief: ".concat((null==e?void 0:e.message)||String(e)))}finally{d(!1)}}async function U(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let r=await fetch("/api/psx/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:e,port:n,lines:["Q=Qi132=?"]})}),l=await r.json(),a=String((null==l?void 0:l.response)||""),i=a.match(/Qi132\D+(\d+)/i)||a.match(/(\d+)/);if(!i||!i[1]){t&&u("Could not parse Qi132 from response");return}let o=Number(i[1]);if(!Number.isFinite(o)){t&&u("Qi132 value not numeric");return}let s=o>>>0;k(String(s)),T(v(s,1)),E(v(s,2)),O((s&1<<b.CLOSED_SSB)!=0?"open":"closed"),t&&u("External power status synced")}catch(e){t&&u("Error syncing power: ".concat((null==e?void 0:e.message)||String(e)))}}async function D(e,t,n){let r=Number(j);if(!j||!Number.isFinite(r)){u("External power base (Qi132) not loaded yet");return}d(!0);try{let l=await fetch("/api/psx/power",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({base:r,ext1:e,ext2:t,ssb:n})}),a=await l.json();u((null==a?void 0:a.ok)?"Power set (Qi132=".concat(null==a?void 0:a.next,")"):"Error: ".concat((null==a?void 0:a.error)||"HTTP ".concat(l.status)))}catch(e){u("Error: ".concat((null==e?void 0:e.message)||String(e)))}finally{d(!1)}}(0,l.useEffect)(()=>{try{let e=(0,f.ri)();e.psxHost&&t(e.psxHost),e.psxPort&&a(e.psxPort)}catch(e){}F()},[F]),(0,l.useEffect)(()=>{let e=()=>{U(!1)};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[e,n]);let H="text-xs rounded-md border bg-neutral-200 text-neutral-900 hover:bg-neutral-300 border-neutral-400 dark:bg-neutral-800 dark:text-neutral-100 dark:hover:bg-neutral-700 dark:border-neutral-600";return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("span",{className:["px-2 py-0.5 rounded-full","checking"===i?"bg-yellow-500/20 text-yellow-700 dark:text-yellow-400":"up"===i?"bg-green-500/20 text-green-700 dark:text-green-400":"bg-red-500/20 text-red-700 dark:text-red-400"].join(" "),children:"checking"===i?"Checking…":"up"===i?"PSX Online":"PSX Offline"}),(0,r.jsx)("button",{onClick:()=>void F(),className:"px-2 py-1 ".concat(H),children:"Recheck"}),(0,r.jsx)("button",{onClick:()=>void U(!0),className:"px-2 py-1 ".concat(H),children:"Refresh Power"})]}),(0,r.jsxs)("section",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)("header",{className:"px-3 py-2 border-b border-neutral-200 dark:border-neutral-800 bg-white/60 dark:bg-neutral-900/60",children:(0,r.jsx)("h3",{className:"text-sm font-semibold",children:"Pushback"})}),(0,r.jsxs)("div",{className:"p-3 space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("label",{className:"text-[12px] opacity-80",children:"Heading"}),(0,r.jsx)("input",{value:String(m),onChange:e=>h(function(e,t){let n=parseInt(String(null!=e?e:"").trim(),10);return Number.isFinite(n)?n:0}(e.target.value,0)),placeholder:"000",className:"w-20 rounded-md border px-2 py-1 bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700"}),(0,r.jsxs)("label",{className:"ml-2 inline-flex items-center gap-1 text-[11px] opacity-80",children:[(0,r.jsx)("input",{type:"checkbox",checked:p,onChange:e=>x(e.target.checked)}),(0,r.jsx)("span",{children:"Hold turn (re-send)"})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)("button",{disabled:s,onClick:()=>fetch("/api/psx/pushback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"start",direction:"back",heading:m})}),className:"px-3 py-1 ".concat(H),children:"Start Back"}),(0,r.jsx)("button",{disabled:s,onClick:()=>fetch("/api/psx/pushback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"start",direction:"forward",heading:m})}),className:"px-3 py-1 ".concat(H),children:"Start Forward"}),(0,r.jsx)("button",{disabled:s,onClick:()=>fetch("/api/psx/pushback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"turn",direction:"back",heading:m,hold:p,key:"pb"})}),className:"px-3 py-1 ".concat(H),children:"Turn (Back)"}),(0,r.jsx)("button",{disabled:s,onClick:()=>fetch("/api/psx/pushback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"turn",direction:"forward",heading:m,hold:p,key:"pb"})}),className:"px-3 py-1 ".concat(H),children:"Turn (Forward)"}),(0,r.jsx)("button",{disabled:s,onClick:()=>fetch("/api/psx/pushback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"release",heading:m,key:"pb"})}),className:"px-3 py-1 ".concat(H),children:"Release Hold"}),(0,r.jsx)("button",{disabled:s,onClick:()=>fetch("/api/psx/pushback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"stop",heading:m,key:"pb"})}),className:"px-3 py-1 ".concat(H),children:"Stop"})]})]})]}),(0,r.jsxs)("section",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)("header",{className:"px-3 py-2 border-b border-neutral-200 dark:border-neutral-800 bg-white/60 dark:bg-neutral-900/60",children:(0,r.jsx)("h3",{className:"text-sm font-semibold",children:"Ground Power & Air"})}),(0,r.jsxs)("div",{className:"p-3 space-y-3 text-sm",children:[(0,r.jsx)("div",{className:"text-[11px] uppercase tracking-wide opacity-60",children:"External Power (Qi132)"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)("button",{disabled:s,onClick:()=>void U(!0),className:"px-2 py-1 ".concat(H),children:"Refresh"}),(0,r.jsxs)("button",{disabled:s,onClick:()=>{let e="avail"===S?"notavail":"avail";T(e),D(e,C,A)},className:["ml-4 px-2 py-1 text-xs rounded-md border","connected"===S?"bg-green-500/20 text-green-700 dark:text-green-400 border-green-700/40":"avail"===S?"bg-blue-500/20 text-blue-700 dark:text-blue-400 border-blue-700/40":"bg-red-500/20 text-red-700 dark:text-red-400 border-red-700/40"].join(" "),children:["Ext1: ","notavail"===S?"Not Avail":"avail"===S?"Avail":"Connected"]}),(0,r.jsxs)("button",{disabled:s,onClick:()=>{let e="avail"===C?"notavail":"avail";E(e),D(S,e,A)},className:["px-2 py-1 text-xs rounded-md border","connected"===C?"bg-green-500/20 text-green-700 dark:text-green-400 border-green-700/40":"avail"===C?"bg-blue-500/20 text-blue-700 dark:text-blue-400 border-blue-700/40":"bg-red-500/20 text-red-700 dark:text-red-400 border-red-700/40"].join(" "),children:["Ext2: ","notavail"===C?"Not Avail":"avail"===C?"Avail":"Connected"]}),(0,r.jsxs)("button",{disabled:s,onClick:()=>{let e="closed"===A?"open":"closed";O(e),D(S,C,e)},className:["px-2 py-1 text-xs rounded-md border","open"===A?"bg-green-500/20 text-green-700 dark:text-green-400 border-green-700/40":"bg-red-500/20 text-red-700 dark:text-red-400 border-red-700/40"].join(" "),children:["SSB: ","open"===A?"Open":"Closed"]})]}),(0,r.jsx)("div",{className:"text-[11px] uppercase tracking-wide opacity-60",children:"External Air (Qi174)"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("label",{className:"inline-flex items-center gap-2 text-[12px] opacity-80",children:[(0,r.jsx)("input",{type:"checkbox",checked:R,onChange:e=>P(e.target.checked)})," ","Bleed"]}),(0,r.jsxs)("label",{className:"inline-flex items-center gap-2 text-[12px] opacity-80",children:[(0,r.jsx)("input",{type:"checkbox",checked:M,onChange:e=>I(e.target.checked)})," ","AirCon"]}),(0,r.jsx)("button",{disabled:s,onClick:async()=>{d(!0);try{let e=await fetch("/api/psx/air",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bleed:R,aircon:M})}),t=await e.json();u((null==t?void 0:t.ok)?"Air set (Qi174=".concat(null==t?void 0:t.bits,")"):"Error: ".concat((null==t?void 0:t.error)||"HTTP ".concat(e.status)))}catch(e){u("Error: ".concat((null==e?void 0:e.message)||String(e)))}finally{d(!1)}},className:"px-2 py-1 ".concat(H),children:"Apply"})]})]})]}),(0,r.jsxs)("section",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)("header",{className:"px-3 py-2 border-b border-neutral-200 dark:border-neutral-800 bg-white/60 dark:bg-neutral-900/60",children:(0,r.jsx)("h3",{className:"text-sm font-semibold",children:"Weights & Fuel"})}),(0,r.jsxs)("div",{className:"p-3 space-y-3 text-sm",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)("label",{className:"block text-[11px] opacity-60",children:"ZFW (kg)"}),(0,r.jsx)("input",{value:g,onChange:e=>y(e.target.value),placeholder:"e.g. 240000",className:"w-28 rounded-md border px-2 py-1 bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700"}),(0,r.jsx)("button",{disabled:s||!g,onClick:async()=>{let e=Math.round(Number(g));if(!Number.isFinite(e)||e<=0){u("ZFW must be a positive number in kg");return}d(!0);try{let t=await fetch("/api/psx/wb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({zfwKg:e})}),n=await t.json();u((null==n?void 0:n.ok)?"ZFW sent: ".concat(e.toLocaleString("en-US")," kg"):"Error: ".concat((null==n?void 0:n.error)||"HTTP ".concat(t.status)))}catch(e){u("Error: ".concat((null==e?void 0:e.message)||String(e)))}finally{d(!1)}},className:"px-2 py-1 ".concat(H),children:"Set via PSX"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)("label",{className:"block text-[11px] opacity-60",children:"Fuel (kg)"}),(0,r.jsx)("input",{value:w,onChange:e=>N(e.target.value),placeholder:"e.g. 110000",className:"w-32 rounded-md border px-2 py-1 bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700"}),(0,r.jsx)("button",{disabled:s||!w,onClick:async()=>{let e=Math.round(Number(w));if(!Number.isFinite(e)||e<=0){u("Fuel must be a positive number in kg");return}if(e>25e4){u("Fuel value looks too high, max 250000 kg");return}d(!0);try{let t=await fetch("/api/psx/fuel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"total",totalKg:e})}),n=await t.json();u((null==n?void 0:n.ok)?"Fuel set: ".concat(e.toLocaleString("en-US")," kg"):"Error: ".concat((null==n?void 0:n.error)||"HTTP ".concat(t.status)))}catch(e){u("Error: ".concat((null==e?void 0:e.message)||String(e)))}finally{d(!1)}},className:"px-2 py-1 ".concat(H),children:"Set via PSX"})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{disabled:s,onClick:()=>void L(),className:"px-3 py-1 ".concat(H),children:"Load ZFW & Fuel from SimBrief"})})]})]}),c&&(0,r.jsx)("div",{className:"text-[11px] opacity-70",children:c})]})}let y=["noseCargo","fwdOvhd","mainElec","L1","UL","L2","L3","L4","sideCargo","L5","R1","fwdCargo","UR","R2","ctrElec","R3","R4","aftCargo","bulkCargo","R5"],w={noseCargo:"Nose Cargo",fwdOvhd:"Fwd Ovhd",mainElec:"Main Elec",L1:"Entry 1",UL:"Upper Deck",L2:"Entry 2",L3:"Entry 3",L4:"Entry 4",sideCargo:"Side Cargo",L5:"Entry 5",R1:"Entry 1",fwdCargo:"Fwd Cargo",UR:"Upper Deck",R2:"Entry 2",ctrElec:"Ctr Elec",R3:"Entry 3",R4:"Entry 4",aftCargo:"Aft Cargo",bulkCargo:"Bulk Cargo",R5:"Entry 5"},N=["noseCargo","fwdOvhd"],j=[["mainElec","L1"],["UL","L2"],["L3"],["L4"],["L5"]],k=[["R1"],["fwdCargo","UR"],["R2","ctrElec"],["R3"],["R4","aftCargo","bulkCargo"],["R5"]];function S(){let[e,t]=(0,l.useState)(!1),[n,a]=(0,l.useState)(""),[i,o]=(0,l.useState)(()=>Object.fromEntries(y.map(e=>[e,!1]))),[s,d]=(0,l.useState)(()=>Object.fromEntries(y.map(e=>[e,!1])));async function c(){try{let e=await fetch("/api/psx/doors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"takeControl"})}),t=await e.json();a((null==t?void 0:t.ok)?"Control requested":"Error: ".concat((null==t?void 0:t.error)||"HTTP ".concat(e.status)))}catch(e){a("Error: ".concat((null==e?void 0:e.message)||String(e)))}}async function u(e){t(!0),a("");try{let t=await fetch("/api/psx/doors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"set",open:e,manual:s})}),n=await t.json();a((null==n?void 0:n.ok)?"Updated":"Error: ".concat((null==n?void 0:n.error)||"HTTP ".concat(t.status)))}catch(e){a("Error: ".concat((null==e?void 0:e.message)||String(e)))}finally{t(!1)}}function m(t){let{k:n,align:l}=t,a=!!i[n];return(0,r.jsx)("button",{type:"button",disabled:e,onClick:()=>{o(e=>{let t={...e,[n]:!e[n]};return u(t),t})},className:["px-3 py-1 text-[11px] font-mono tracking-wide rounded-sm border transition-colors","min-w-[90px]","left"===l?"justify-start text-left":"right"===l?"justify-end text-right":"justify-center text-center","flex items-center",a?"bg-yellow-300 text-black border-yellow-400":"bg-transparent text-sky-300 border-sky-300/70 hover:bg-sky-300/10"].join(" "),children:w[n].toUpperCase()})}function h(e){let{keys:t,side:n}=e;return(0,r.jsx)("div",{className:"flex flex-col gap-1 my-1",children:t.map(e=>(0,r.jsx)(m,{k:e,align:"left"===n?"right":"left"},e))})}return(0,l.useEffect)(()=>{c()},[]),(0,l.useEffect)(()=>{let e=!1;async function t(){try{let t=await fetch("/api/psx/doors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"status"})});if(!t.ok)return;let n=await t.json();if(e||!(null==n?void 0:n.ok))return;n.open&&o(e=>{let t={...e};for(let e of y)e in n.open&&(t[e]=!!n.open[e]);return t}),n.manual&&d(e=>{let t={...e};for(let e of y)e in n.manual&&(t[e]=!!n.manual[e]);return t})}catch(e){}}t();let n=setInterval(t,2e3);return()=>{e=!0,clearInterval(n)}},[]),(0,r.jsxs)("section",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)("header",{className:"px-3 py-2 border-b border-neutral-200 dark:border-neutral-800 bg-white/60 dark:bg-neutral-900/60",children:(0,r.jsx)("h3",{className:"text-sm font-semibold",children:"Doors"})}),(0,r.jsxs)("div",{className:"p-3 space-y-4 text-sm",children:[(0,r.jsx)("div",{className:"flex justify-center gap-2 flex-wrap",children:N.map(e=>(0,r.jsx)(m,{k:e,align:"center"},e))}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center gap-6 sm:gap-10 md:gap-14",children:[(0,r.jsx)("div",{className:"flex flex-col justify-between",children:j.map((e,t)=>(0,r.jsx)(h,{keys:e,side:"left"},t))}),(0,r.jsx)("div",{className:"flex flex-col justify-between",children:k.map((e,t)=>(0,r.jsx)(h,{keys:e,side:"right"},t))})]}),n&&(0,r.jsx)("div",{className:"text-[11px] opacity-70",children:n})]})]})}let T=["flight","ofp","map","notams","wx","acars","checklists_sops","psx","audio"],C="covey_last_simbrief_pdf";async function E(e){let t=await e.text();try{return JSON.parse(t)}catch(e){return{ok:!1,text:t}}}function A(e){let t=(e||"").toUpperCase();return/\b(RWY|RUNWAY|QMR|RWY\d{2}[LRC]?|THR|STOPWAY|RESA|ARREST)\b/.test(t)?"Runway":/\b(TWY|TAXIWAY|QMX|HOLD(?:ING)? POINT|HST)\b/.test(t)?"Taxiway":/\b(APRON|STAND|GATE|BAY|RAMP)\b/.test(t)?"Apron/Stand":/\b(ILS|LLZ|LOC|GS|DME|VOR|DVOR|NDB|TACAN|VORTAC|RNAV|RNP|GNSS|PAPI|VASIS?)\b/.test(t)?"Nav Aids":/\b(ATIS|TWR|APP|ACC|AFIS|FIS|RADAR|COM|FREQ|CPDLC|DATALINK|RCO)\b/.test(t)?"Comms/ATC":/\b(CTR|TMA|AIRSPACE|PROHIBITED|RESTRICTED|DANGER|TRA|TEMP(?:ORARY)? RESERVED)\b/.test(t)?"Airspace":/\b(OBST|CRANE|WIP|WORK IN PROGRESS|BIRD|SNOW|ICE|BRAKING ACTION|ARFF|RFFS?|AD\s?CLSD|AERODROME)\b/.test(t)?"Aerodrome":"Other"}function O(e){let{visible:t}=e;return(0,r.jsx)("div",{className:["h-full w-full rounded-lg border border-neutral-200 dark:border-neutral-800",t?"block":"block opacity-0 pointer-events-none absolute inset-0"].join(" "),children:(0,r.jsxs)("div",{className:"relative h-full w-full",children:[(0,r.jsx)("iframe",{src:"https://map.vatsim.net/",title:"VATSIM Radar",className:"w-full h-full rounded-lg",referrerPolicy:"strict-origin-when-cross-origin",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",allow:"geolocation; fullscreen; clipboard-read; clipboard-write; accelerometer; gyroscope"}),(0,r.jsx)("div",{className:"pointer-events-none absolute inset-x-2 bottom-2 flex justify-end",children:(0,r.jsx)("a",{href:"https://map.vatsim.net/",target:"_blank",rel:"noreferrer noopener",className:"pointer-events-auto text-xs px-2.5 py-1.5 rounded-md bg-black/70 text-white shadow-md backdrop-blur",children:"Open VATSIM Radar (new tab)"})})]})})}function R(e){return(e||"").trim().toUpperCase()}function P(e){if(!e)return[];let t=new Set(["AIRPORT","AERODROME","INTL","INTERNATIONAL","FIELD","AP","APT"]);return e.replace(/[()]/g," ").split(/[\s\-\/,]+/).map(e=>e.trim().toUpperCase()).filter(e=>e.length>=3&&!t.has(e))}function M(e){var t,n,r,l;let a=[];if(!e)return a;let i=R(null===(t=e.origin)||void 0===t?void 0:t.icao),o=R(null===(n=e.destination)||void 0===n?void 0:n.icao),s=function(e){let t=R(e);return t?t.split(/[\s,\/;|]+/).map(e=>e.trim()).filter(e=>/^[A-Z]{4}$/.test(e)):[]}(e.alternate);return i&&a.push({code:i,names:P(null===(r=e.origin)||void 0===r?void 0:r.name),rank:0}),o&&a.push({code:o,names:P(null===(l=e.destination)||void 0===l?void 0:l.name),rank:1}),s.forEach((e,t)=>{a.push({code:e,names:[],rank:2+t})}),a}let I=new Set(["ACFT","WILL","NOTE","PAGE","READ","WITH","ONLY","INTO","BLUE","FIRE","EAST","FLOW","GRID","HIGH","HLDG","OBST","TKOF","TODA","AREA","PLAN","PORT","WIND","INFO","BIRD","CLSD","RUNS"]);function F(){let[e,t]=(0,l.useState)("flight"),[n,i]=(0,l.useState)(!1),[o,s]=(0,l.useState)(!1),[d,c]=(0,l.useState)(""),[m,h]=(0,l.useState)(""),[p,b]=(0,l.useState)(""),[v,y]=(0,l.useState)(null),[w,N]=(0,l.useState)(null),[j,k]=(0,l.useState)(!1),[P,F]=(0,l.useState)(null),[L,U]=(0,l.useState)(null),[D,H]=(0,l.useState)(!1),[_,B]=(0,l.useState)(null),W=(0,l.useRef)(null),J=(0,l.useRef)([]),G=(0,l.useRef)([]),[V,X]=(0,l.useState)(null),[Q,Z]=(0,l.useState)(!1),[K,q]=(0,l.useState)(null),[z,Y]=(0,l.useState)(null),[$,ee]=(0,l.useState)(!1),[et,en]=(0,l.useState)(null),er=(0,l.useMemo)(()=>d?"?username=".concat(encodeURIComponent(d)):"",[d]),[el,ea]=(0,l.useState)(""),[ei,eo]=(0,l.useState)(""),[es,ed]=(0,l.useState)("ATC"),[ec,eu]=(0,l.useState)(""),[em,eh]=(0,l.useState)(!1),[ep,ex]=(0,l.useState)(null),[ef,eb]=(0,l.useState)("telex"),[ev,eg]=(0,l.useState)([]),[ey,ew]=(0,l.useState)(!1),eN=(0,l.useRef)(new Set),[ej,ek]=(0,l.useState)(0),eS=(0,l.useMemo)(()=>{let e=(el||"").trim(),t=(ei||"").trim();return e&&t?"acars_inbox_".concat(e,"_").concat(t):null},[el,ei]);async function eT(){try{eh(!0),ex(null);let e=await fetch("/api/acars/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({logon:el,from:ei,to:es,type:ef,text:ec})}),t=await e.json();if(!e.ok||!(null==t?void 0:t.ok))throw Error((null==t?void 0:t.error)||"HTTP ".concat(e.status));eu("")}catch(e){ex((null==e?void 0:e.message)||"Failed to send")}finally{eh(!1)}}async function eC(){try{ex(null);let t=new URLSearchParams({logon:el,from:ei}).toString(),n=await fetch("/api/acars/inbox?".concat(t),{cache:"no-store"}),r=await n.json();if(!n.ok||!(null==r?void 0:r.ok))throw Error((null==r?void 0:r.error)||"HTTP ".concat(n.status));let l=Array.isArray(r.messages)?r.messages:[],a=l;try{if(eS){let e=localStorage.getItem(eS),t=e?JSON.parse(e):[],n=new Set,r=e=>"".concat(e.time||"","|").concat(e.from||"","|").concat(e.to||"","|").concat(e.text||"");for(let e of t)n.add(r(e));let i=[...t];for(let e of l){let t=r(e);n.has(t)||(n.add(t),i.push(e))}a=i.slice(-200),localStorage.setItem(eS,JSON.stringify(a))}}catch(e){}eg(a);let i=0;for(let e of l){let t="".concat(e.time||"","|").concat(e.from||"","|").concat(e.to||"","|").concat(e.text||"");!eN.current.has(t)&&(eN.current.add(t),i++)}if(i>0){"acars"===e?ek(0):ek(e=>e+i);try{let e=window.AudioContext||window.webkitAudioContext;if(e){let t=new e,n=t.createOscillator(),r=t.createGain();n.type="sine",n.frequency.value=880,n.connect(r),r.connect(t.destination);let l=t.currentTime;r.gain.setValueAtTime(1e-4,l),r.gain.exponentialRampToValueAtTime(.1,l+.01),r.gain.exponentialRampToValueAtTime(1e-4,l+.25),n.start(l),n.stop(l+.25)}}catch(e){}}}catch(e){ex((null==e?void 0:e.message)||"Failed to load inbox")}}(0,l.useEffect)(()=>{let e=(0,f.ri)();e.hoppieLogon&&ea(e.hoppieLogon)},[]),(0,l.useEffect)(()=>{let e=()=>{try{let e=(0,f.ri)();s(!!e.psxEnabled)}catch(e){}};return e(),window.addEventListener(f.wj,e),window.addEventListener("storage",e),()=>{window.removeEventListener(f.wj,e),window.removeEventListener("storage",e)}},[]),(0,l.useEffect)(()=>{o||"psx"!==e||t("flight")},[o,e]),(0,l.useEffect)(()=>{let e=((null==_?void 0:_.callsign)||"").trim(),t=((null==P?void 0:P.callsign)||"").trim(),n=e||t||"";n&&eo(n.toUpperCase())},[null==_?void 0:_.callsign,null==P?void 0:P.callsign]),(0,l.useEffect)(()=>{let e;let t=!!(el&&ei);if(t){try{if(eS){let e=localStorage.getItem(eS);if(e){let t=JSON.parse(e);Array.isArray(t)&&eg(t)}}}catch(e){}e=window.setInterval(()=>{t&&eC()},2e4),eC()}return()=>{e&&window.clearInterval(e)}},[el,ei,eS]),(0,l.useEffect)(()=>{"acars"===e&&ek(0)},[e]);let[eE,eA]=(0,l.useState)(new Set),[eO,eR]=(0,l.useState)(new Set),[eP,eM]=(0,l.useState)(new Set),[eI,eF]=(0,l.useState)(1);async function eL(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{silent:n=!1}=t;if(e||!v){if(!d){n||N("Please set your SimBrief username in Settings.");return}n||(k(!0),N(null));try{let e=await fetch("/api/simbrief/ofp-latest-pdf".concat(er),{cache:"no-store"}),t=await E(e);if(!e.ok||!(null==t?void 0:t.ok)||!(null==t?void 0:t.url))throw Error((null==t?void 0:t.error)||"Invalid server response.");let n=await fetch("/api/simbrief/validate-pdf?url=".concat(encodeURIComponent(t.url))),r=await E(n);if(!n.ok||!(null==r?void 0:r.ok))throw Error((null==r?void 0:r.error)||"PDF could not be validated.");y(r.url),localStorage.setItem(C,r.url)}catch(e){if(!n){let t=localStorage.getItem(C);t?(y(t),N("".concat((null==e?void 0:e.message)||"Failed"," — showing last known PDF."))):N((null==e?void 0:e.message)||"Failed to load OFP PDF.")}}finally{n||k(!1)}}}async function eU(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(d){e||(H(!0),U(null));try{var t,n,r,l,a,i,o,s,c,u,m,h,p,x,f;let e=await fetch("/api/simbrief/summary".concat(er),{cache:"no-store"}),d=await E(e);if(!e.ok||!(null==d?void 0:d.ok))throw Error((null==d?void 0:d.error)||"HTTP ".concat(e.status));F({origin:null!==(t=d.origin)&&void 0!==t?t:null,destination:null!==(n=d.destination)&&void 0!==n?n:null,alternate:null!==(r=d.alternate)&&void 0!==r?r:null,schedOut:null!==(l=d.schedOut)&&void 0!==l?l:null,schedIn:null!==(a=d.schedIn)&&void 0!==a?a:null,companyRoute:null!==(i=d.companyRoute)&&void 0!==i?i:null,zfw:null!==(o=d.zfw)&&void 0!==o?o:null,costIndex:null!==(s=d.costIndex)&&void 0!==s?s:null,avgWind:null!==(c=d.avgWind)&&void 0!==c?c:null,cruiseAlt:null!==(u=d.cruiseAlt)&&void 0!==u?u:null,route:null!==(m=d.route)&&void 0!==m?m:null,callsign:null!==(h=d.callsign)&&void 0!==h?h:null,plannedDistanceNm:null!==(p=d.plannedDistanceNm)&&void 0!==p?p:null,plannedEte:null!==(x=d.plannedEte)&&void 0!==x?x:null,plannedFuel:null!==(f=d.plannedFuel)&&void 0!==f?f:null})}catch(e){U((null==e?void 0:e.message)||"Failed to load flight summary.")}finally{e||H(!1)}}}async function eD(){var e,t,n,r,l,a,i,o,s,d,c,u,h,p,x,f,b,v,g,y,w,N,j,k,S,T,C,A,O,R,M,I,F,L,U,D,H,_,W,V,X,Q,Z,K,q,z,Y,$,ee,et,en,er,el,ea;let ei=m.trim(),eo=null==P?void 0:null===(e=P.callsign)||void 0===e?void 0:e.trim();if(!ei&&!eo){B({online:!1});return}try{let e=ei?"/api/vatsim/online?cid=".concat(encodeURIComponent(ei)):"/api/vatsim/pilot?callsign=".concat(encodeURIComponent(eo)),m=await fetch(e,{cache:"no-store"}),es=await E(m);if(!m.ok||!(null==es?void 0:es.ok))throw Error((null==es?void 0:es.error)||"HTTP ".concat(m.status));if(!es.online){B({online:!1});return}let ed=es.pilot||es||{},ec=ed.flight_plan||ed.fp||{},eu=Number(null!==(s=null!==(o=ed.latitude)&&void 0!==o?o:ed.lat)&&void 0!==s?s:NaN),em=Number(null!==(c=null!==(d=ed.longitude)&&void 0!==d?d:ed.lon)&&void 0!==c?c:NaN),eh=Number(null!==(p=null!==(h=null!==(u=ed.groundspeed)&&void 0!==u?u:ed.ground_speed)&&void 0!==h?h:ed.gs)&&void 0!==p?p:0)||0,ep=Number(null!==(b=null!==(f=null!==(x=ed.altitude)&&void 0!==x?x:ed.altitude_ft)&&void 0!==f?f:ed.alt)&&void 0!==b?b:0)||0,ex=Number(null!==(y=null!==(g=null!==(v=ed.heading)&&void 0!==v?v:ed.heading_deg)&&void 0!==g?g:ed.hdg)&&void 0!==y?y:0)||0,ef=(null!==(N=null!==(w=ed.transponder)&&void 0!==w?w:ed.squawk)&&void 0!==N?N:null)?String(null!==(j=ed.transponder)&&void 0!==j?j:ed.squawk):null,eb=null!==(S=null!==(k=ed.frequency)&&void 0!==k?k:ed.com)&&void 0!==S?S:null,ev=(null===(n=null!==(C=null!==(T=ec.departure)&&void 0!==T?T:ec.dep)&&void 0!==C?C:ed.departure)||void 0===n?void 0:null===(t=n.toString())||void 0===t?void 0:t.toUpperCase())||null,eg=(null===(l=null!==(O=null!==(A=ec.arrival)&&void 0!==A?A:ec.arr)&&void 0!==O?O:ed.arrival)||void 0===l?void 0:null===(r=l.toString())||void 0===r?void 0:r.toUpperCase())||null,ey=(null!==(I=null!==(M=null!==(R=ec.alternate)&&void 0!==R?R:ec.altn)&&void 0!==M?M:ec.alternate_icao)&&void 0!==I?I:"").toString().toUpperCase()||null,ew=(null!==(L=null!==(F=ec.callsign)&&void 0!==F?F:ed.callsign)&&void 0!==L?L:"").toString().trim()||null,eN=(null!==(D=null!==(U=ec.route)&&void 0!==U?U:ed.route)&&void 0!==D?D:"").toString().trim()||null,ej=(null!==(V=null!==(W=null!==(_=null!==(H=ec.aircraft)&&void 0!==H?H:ec.aircraft_faa)&&void 0!==_?_:ec.aircraft_icao)&&void 0!==W?W:ed.aircraft)&&void 0!==V?V:"").toString().trim()||null,ek=function(e){if(null==e)return null;let t=String(e).trim().toUpperCase();if(!t)return null;let n=t.match(/(\d{2,4})/);if(!n)return null;let r=parseInt(n[1],10);return Number.isFinite(r)?r:null}(null!==(Z=null!==(Q=null!==(X=ec.tas)&&void 0!==X?X:ec.cruise_tas)&&void 0!==Q?Q:ec.true_air_speed)&&void 0!==Z?Z:null),eS=function(e){if(null==e)return null;let t=String(e).trim().toUpperCase();if(!t)return null;if(t.startsWith("FL")){let e=parseInt(t.slice(2),10);return Number.isFinite(e)?100*e:null}let n=parseInt(t,10);return Number.isFinite(n)?n>4e3?n:100*n:null}(null!==(q=null!==(K=ec.altitude)&&void 0!==K?K:ec.cruise_altitude)&&void 0!==q?q:null),eT=(null!==(Y=null!==(z=ed.name)&&void 0!==z?z:ed.realname)&&void 0!==Y?Y:"").toString()||null,eC=(null!==(ee=null!==($=ed.cid)&&void 0!==$?$:ed.vatsim_cid)&&void 0!==ee?ee:"").toString()||null,eE=(null!==(en=null!==(et=ed.airline)&&void 0!==et?et:function(e){let t=(e||"").trim().toUpperCase();if(!t)return null;let n=t.match(/^[A-Z]{2,3}/);return n?n[0]:null}(ew))&&void 0!==en?en:"").toString()||null,eA=null,eO=null,eR=null,eP=null!==(er=null==P?void 0:null===(a=P.destination)||void 0===a?void 0:a.lat)&&void 0!==er?er:null,eM=null!==(el=null==P?void 0:null===(i=P.destination)||void 0===i?void 0:i.lon)&&void 0!==el?el:null,eI=null!==(ea=null==P?void 0:P.plannedDistanceNm)&&void 0!==ea?ea:null;if(null!=eP&&null!=eM&&Number.isFinite(eu)&&Number.isFinite(em)&&(eA=function(e,t){let n=(t.lat-e.lat)*Math.PI/180,r=(t.lon-e.lon)*Math.PI/180,l=e.lat*Math.PI/180,a=t.lat*Math.PI/180;return 6880.13*Math.asin(Math.min(1,Math.sqrt(Math.sin(n/2)**2+Math.cos(l)*Math.cos(a)*Math.sin(r/2)**2)))}({lat:eu,lon:em},{lat:Number(eP),lon:Number(eM)}),null!=eI&&(eO=Math.max(0,eI-eA)),eh>20&&null!=eA)){let e=Math.round(eA/eh*60);eR="".concat(String(Math.floor(e/60)).padStart(2,"0"),":").concat(String(e%60).padStart(2,"0"))}let eF=function(e,t,n){if((null!=e?e:0)<30&&(null!=t?t:0)<100)return"ground";if(n&&null!=t){if(t<n-1500&&(null!=e?e:0)>200)return"climb";if(t>n+1500&&(null!=e?e:0)>200)return"descent";if(1500>=Math.abs(t-n))return"cruise"}return"unknown"}(eh,ep,eS);J.current.push(eh),J.current.length>10&&J.current.shift(),G.current.push(ep),G.current.length>10&&G.current.shift(),B({online:!0,lat:Number.isFinite(eu)?eu:null,lon:Number.isFinite(em)?em:null,groundspeed:eh,altitudeFt:ep,headingDeg:ex,remainingNm:eA,flownNm:eO,etaText:eR,phase:eF,squawk:ef,com:eb,pilotName:eT,pilotCid:eC,airline:eE,callsign:ew,route:eN,origin:ev?{icao:ev,name:"",lat:null,lon:null}:void 0,destination:eg?{icao:eg,name:"",lat:null,lon:null}:void 0,alternateIcao:ey||void 0,aircraft:ej,tasKts:ek,cruiseAltFt:eS,gsHistory:[...J.current],altHistory:[...G.current]})}catch(e){B({online:!1})}}(0,l.useEffect)(()=>{try{let e=(0,f.ri)();e.simbriefUsername&&c(e.simbriefUsername),e.vatsimCid&&h(e.vatsimCid),e.hoppieLogon&&b(e.hoppieLogon);let t=localStorage.getItem(C);t&&y(t)}catch(e){}},[]),(0,l.useEffect)(()=>{var t;let n=!!((null==m?void 0:m.trim())||(null==P?void 0:null===(t=P.callsign)||void 0===t?void 0:t.trim()));if("flight"!==e||!n){W.current&&(window.clearInterval(W.current),W.current=null);return}return eD(),W.current=window.setInterval(()=>void eD(),15e3),()=>{W.current&&(window.clearInterval(W.current),W.current=null)}},[e,null==P?void 0:P.callsign,m]),(0,l.useEffect)(()=>{d&&(eU(!0),eL(!1,{silent:!0}))},[d]),(0,l.useEffect)(()=>{"ofp"===e&&d&&!v&&eL(!1)},[e,d]);let eH=(0,l.useCallback)(async()=>{if(!(null==d?void 0:d.trim())){X(null),q("Please set your SimBrief username in Settings.");return}Z(!0),q(null);try{let e=await fetch("/api/simbrief/ofp-notams?username=".concat(encodeURIComponent(d)),{cache:"no-store"}),t=await E(e),n=[];if(e.ok&&(null==t?void 0:t.ok)&&Array.isArray(t.items)&&(n=t.items),!n.length){let e=await fetch("/api/simbrief/ofp-xml?username=".concat(encodeURIComponent(d)),{cache:"no-store"});if(e.ok){let t=await e.text(),r=function(e){try{let t=new DOMParser().parseFromString(e,"application/xml"),n=Array.from(t.getElementsByTagName("notam")).map(e=>{var t,n,r,l,a,i,o,s,d,c,u,m;let h=e.getAttribute("icao")||e.getAttribute("station")||(null===(n=e.getElementsByTagName("station"))||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.textContent)||"",p=e.getAttribute("id")||(null===(l=e.getElementsByTagName("id"))||void 0===l?void 0:null===(r=l[0])||void 0===r?void 0:r.textContent)||void 0,x=e.getAttribute("from")||(null===(i=e.getElementsByTagName("from"))||void 0===i?void 0:null===(a=i[0])||void 0===a?void 0:a.textContent)||void 0,f=e.getAttribute("to")||(null===(s=e.getElementsByTagName("to"))||void 0===s?void 0:null===(o=s[0])||void 0===o?void 0:o.textContent)||void 0,b=(null===(u=e.getElementsByTagName("text"))||void 0===u?void 0:null===(c=u[0])||void 0===c?void 0:null===(d=c.textContent)||void 0===d?void 0:d.trim())||(null===(m=e.textContent)||void 0===m?void 0:m.trim())||"";return{station:(h||"OTHER").toUpperCase(),id:p,text:b,starts:x,ends:f,type:A(b)}});if(0===n.length)for(let e of["origin_notams","dest_notams","alternate_notams","notams","airport_notams"])for(let r of Array.from(t.getElementsByTagName(e))){let e=(r.textContent||"").split(/\r?\n/).map(e=>e.trim()).filter(Boolean),t=[],l=[];for(let n of e)if(!/^[-=]{3,}$/.test(n)){if(""===n){l.length&&(t.push(l.join("\n")),l=[]);continue}l.push(n)}for(let e of(l.length&&t.push(l.join("\n")),t)){let t=e.match(/\b[A-Z]{4}\b/);n.push({station:((null==t?void 0:t[0])||"OTHER").toUpperCase(),text:e,type:A(e)})}}return n.map(e=>({...e,id:e.id||void 0,text:e.text.trim(),type:e.type||A(e.text)})).filter(e=>e.text.length>0)}catch(e){return[]}}(t);r.length&&(n=r)}}n=n.map(e=>({...e,type:e.type||A(e.text)})),X(n),n.length||q("No NOTAMs found in the latest OFP.")}catch(e){q((null==e?void 0:e.message)||"Failed to load NOTAMs."),X(null)}finally{Z(!1)}},[d]);(0,l.useEffect)(()=>{"notams"===e&&eH()},[e,eH]);let e_=(0,l.useCallback)(async()=>{try{var e,t;ee(!0),en(null);let n=[null==P?void 0:null===(e=P.origin)||void 0===e?void 0:e.icao,null==P?void 0:null===(t=P.destination)||void 0===t?void 0:t.icao,(null==P?void 0:P.alternate)||null].map(e=>"string"==typeof e?e.trim().toUpperCase():"").filter(e=>/^[A-Z]{4}$/.test(e)),r=Array.from(new Set(n));if(!r.length){Y(null);return}let l=await fetch("/api/wx/metar-taf?stations=".concat(encodeURIComponent(r.join(","))),{cache:"no-store"}),a=await l.json();if(!l.ok||!(null==a?void 0:a.ok))throw Error((null==a?void 0:a.error)||"HTTP ".concat(l.status));Y(a.data||{})}catch(e){en((null==e?void 0:e.message)||"Failed to load METAR/TAF"),Y(null)}finally{ee(!1)}},[P]);(0,l.useEffect)(()=>{"wx"===e&&e_()},[e,e_]);let eB=(0,l.useMemo)(()=>{let e={stations:new Map,otherPlaces:new Map};if(!V)return e;let t=["Runway","Taxiway","Apron/Stand","Nav Aids","Comms/ATC","Airspace","Aerodrome","Other"],n=M(P);for(let t of V){let r=function(e,t){let n=e.text||"",r=R(e.station),l=new Set(t.map(e=>e.code));if(r&&l.has(r))return r;for(let e of t)if(e.code&&n.toUpperCase().includes(e.code))return e.code;let a=t.filter(e=>(function(e,t){if(!t.length)return!1;let n=e.toUpperCase();return t.some(e=>RegExp("\\b".concat(e,"\\b"),"i").test(n))})(n,e.names));return a.length?(a.sort((e,t)=>e.rank-t.rank),a[0].code):null}(t,n);if(r){e.stations.has(r)||e.stations.set(r,new Map);let n=e.stations.get(r),l=t.type||A(t.text);n.has(l)||n.set(l,[]),n.get(l).push({...t,station:r,type:l})}else{let r=function(e,t){let n=e.text||"",r=function(e,t){let n=(e||"").toUpperCase().match(/\b[A-Z]{4}\b/g);if(!n)return null;for(let e of n)if(!t.has(e)&&!I.has(e))return e;return null}(n,new Set(t.map(e=>e.code)));if(r)return r;let l=n.toUpperCase().split(/[^A-Z]+/).filter(e=>e.length>=4&&!I.has(e));return l.length?l[0]:"Misc"}(t,n);e.otherPlaces.has(r)||e.otherPlaces.set(r,new Map);let l=e.otherPlaces.get(r),a=t.type||A(t.text);l.has(a)||l.set(a,[]),l.get(a).push({...t,station:"OTHER",type:a})}}let r=e=>{for(let[,n]of e){for(let[e,t]of n)t.sort((e,t)=>{let n=e.id?parseInt(e.id.replace(/\D/g,""),10):NaN,r=t.id?parseInt(t.id.replace(/\D/g,""),10):NaN;return Number.isFinite(n)&&Number.isFinite(r)&&n!==r?n-r:e.id&&t.id?e.id.localeCompare(t.id):e.id?-1:t.id?1:e.text.localeCompare(t.text)});let e=new Map;for(let[r,l]of([...t,...[...n.keys()].sort()].forEach(t=>{n.has(t)&&!e.has(t)&&e.set(t,n.get(t))}),n.clear(),e))n.set(r,l)}};r(e.stations),r(e.otherPlaces);let l=M(P).map(e=>e.code),a=new Map([...e.stations.entries()].sort((e,t)=>{let[n]=e,[r]=t,a=l.indexOf(n),i=l.indexOf(r);return -1!==a||-1!==i?-1===a?1:-1===i?-1:a-i:n.localeCompare(r)}));return e.stations=a,e.otherPlaces=new Map([...e.otherPlaces.entries()].sort((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)})),e},[V,P]),eW=n=>{n!==e&&(i(!0),setTimeout(()=>{t(n),i(!1)},120))},eJ=(e,t,n)=>Math.min(n,Math.max(t,e)),eG="ofp"===e?"h-full rounded-lg p-0 bg-transparent overflow-hidden":"h-full rounded-lg bg-neutral-50 dark:bg-neutral-900/40 p-3 overflow-hidden",eV="ofp"===e?"h-full p-0 m-0 rounded-none border-0 overflow-hidden":"h-full rounded-lg border border-neutral-200 dark:border-neutral-800 p-4 overflow-auto",eX=e=>{switch(e){case"ofp":return"OFP";case"map":return"Map";case"notams":return"NOTAM";case"wx":return"METAR/TAF";case"acars":return"ACARS";case"checklists_sops":return"Checklists & SOPs";case"psx":return"PSX";case"audio":return"Audio";default:return"Flight"}},eQ=o?T:T.filter(e=>"psx"!==e),eZ=e=>{eA(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},eK=(e,t)=>{let n="".concat(e,"|").concat(t),r=new Set(eO);r.has(n)?r.delete(n):r.add(n),eR(r)},eq=e=>{let t=new Set(eP);t.has(e)?t.delete(e):t.add(e),eM(t)};return(0,r.jsx)(a.s,{title:"Main Area",actions:(0,r.jsx)("nav",{className:"flex items-center gap-2",children:eQ.map(t=>{let l=e===t&&!n;return(0,r.jsx)("button",{onClick:()=>eW(t),className:["text-xs px-3 py-1.5 rounded-md border transition",l?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900","border-neutral-200 dark:border-neutral-700"].join(" "),children:"acars"===t?(0,r.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,r.jsx)("span",{"aria-hidden":!0,children:"✉️"}),(0,r.jsx)("span",{children:"ACARS"}),ej>0&&(0,r.jsx)("span",{className:"ml-1 inline-flex items-center justify-center min-w-[1.25rem] h-5 px-1 rounded-full text-[10px] font-semibold bg-red-600 text-white",children:ej})]}):eX(t)},t)})}),className:"flex-1 min-h-0",children:(0,r.jsx)("div",{className:eG,children:(0,r.jsxs)("div",{className:[eV,"transition-opacity duration-150 relative",n?"opacity-0":"opacity-100"].join(" "),children:["flight"===e&&(0,r.jsx)("div",{className:"h-full overflow-auto",children:(0,r.jsx)(x,{data:P,loading:D,error:L||void 0,vatsim:_||void 0,className:"w-full"})}),"ofp"===e&&(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-3 py-2",children:[(0,r.jsxs)("p",{className:"text-xs opacity-60",children:["OFP PDF (latest",d?" — ".concat(d):"",")"]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:()=>eF(e=>eJ(Math.round((e-.1)*100)/100,.5,3)),className:"text-xs px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:"−"}),(0,r.jsxs)("button",{onClick:()=>eF(1),className:"text-xs px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:[Math.round(100*eI),"%"]}),(0,r.jsx)("button",{onClick:()=>eF(e=>eJ(Math.round((e+.1)*100)/100,.5,3)),className:"text-xs px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:"+"}),(0,r.jsx)("button",{onClick:()=>eL(!0),disabled:j,className:"ml-2 text-xs px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:j?"Refreshing…":"Refresh"})]})]}),j&&(0,r.jsx)("div",{className:"px-3 pb-2 text-sm",children:"Resolving PDF link…"}),w&&(0,r.jsxs)("div",{className:"px-3 pb-2 space-y-2",children:[(0,r.jsxs)("p",{className:"text-red-500 text-sm",children:["Error: ",w]}),(0,r.jsxs)("p",{className:"text-xs opacity-70",children:["If the server cannot see your SimBrief session, click"," ",(0,r.jsx)("a",{href:"https://dispatch.simbrief.com/briefing/latest",target:"_blank",rel:"noreferrer",className:"underline",children:"View PDF"})," ","once to generate a public link."]})]}),(0,r.jsx)("div",{className:"flex-1 min-h-0 overflow-auto",children:v?(0,r.jsx)(u,{src:v,zoom:eI,className:"h-full",style:{width:"100%"}},v+":"+eI):!j&&(0,r.jsx)("div",{className:"h-full flex items-center justify-center opacity-70 text-sm",children:d?"No PDF link found for the latest OFP.":"Please set your SimBrief username in Settings."})})]}),(0,r.jsx)("div",{className:"map"===e?"h-full relative":"h-0",children:(0,r.jsx)(O,{visible:"map"===e})}),"notams"===e&&(0,r.jsx)("div",{className:"h-full overflow-hidden",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-full",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 h-full overflow-auto",children:[(0,r.jsxs)("div",{className:"mb-3 flex items-center justify-end hidden",children:[(0,r.jsx)("p",{className:"text-xs opacity-60",children:d?"Source: SimBrief — ".concat(d):"No SimBrief username set."}),(0,r.jsx)("button",{onClick:()=>eH(),className:"text-xs px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:"Refresh"})]}),Q&&(0,r.jsx)("div",{className:"text-sm",children:"Loading NOTAMs…"}),K&&(0,r.jsx)("div",{className:"text-sm text-red-600",children:K}),!Q&&!K&&(0,r.jsxs)(r.Fragment,{children:[(!V||0===V.length)&&(0,r.jsx)("div",{className:"text-sm opacity-70",children:"No NOTAMs found in the OFP."}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[Array.from(eB.stations.keys()).map(e=>{let t=Array.from(eB.stations.get(e).values()).reduce((e,t)=>e+t.length,0),n=eE.has(e);return(0,r.jsxs)("button",{onClick:()=>eZ(e),className:["text-sm font-medium px-4 py-2 rounded-md border transition",n?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900","border-neutral-200 dark:border-neutral-700"].join(" "),title:"".concat(t," NOTAM").concat(1!==t?"s":""),children:[e," (",t,")"]},e)}),eB.otherPlaces.size>0&&(0,r.jsxs)("button",{onClick:()=>eZ("OTHER"),className:["text-sm font-medium px-4 py-2 rounded-md border transition",eE.has("OTHER")?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900","border-neutral-200 dark:border-neutral-700"].join(" "),children:["OTHER / FIR / Misc (",Array.from(eB.otherPlaces.values()).reduce((e,t)=>e+Array.from(t.values()).reduce((e,t)=>e+t.length,0),0),")"]})]}),Array.from(eB.stations.entries()).map(e=>{let[t,n]=e;return eE.has(t)?(0,r.jsxs)("section",{className:"mb-6 rounded-lg border border-neutral-200 dark:border-neutral-800",children:[(0,r.jsxs)("header",{className:"px-3 py-2 border-b border-neutral-200 dark:border-neutral-800 bg-white/60 dark:bg-neutral-900/60",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold",children:t}),(0,r.jsxs)("p",{className:"text-xs opacity-60",children:[Array.from(n.values()).reduce((e,t)=>e+t.length,0)," ","NOTAMs"]})]}),(0,r.jsx)("div",{className:"p-3 flex flex-wrap gap-2",children:Array.from(n.entries()).map(e=>{let[n,l]=e,a="".concat(t,"|").concat(n),i=eO.has(a);return(0,r.jsxs)("button",{onClick:()=>eK(t,n),className:["text-xs px-3 py-1.5 rounded-md border transition",i?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900","border-neutral-200 dark:border-neutral-700"].join(" "),title:"".concat(l.length," NOTAM").concat(1!==l.length?"s":""),children:[n," (",l.length,")"]},a)})}),Array.from(n.entries()).map(e=>{let[n,l]=e,a="".concat(t,"|").concat(n);return eO.has(a)?(0,r.jsxs)("div",{className:"border-t border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)("div",{className:"px-3 py-2 bg-neutral-50/60 dark:bg-neutral-900/40",children:(0,r.jsxs)("h4",{className:"text-xs font-semibold",children:[n," ",(0,r.jsxs)("span",{className:"opacity-60 font-normal",children:["(",l.length,")"]})]})}),(0,r.jsx)("ul",{className:"divide-y divide-neutral-200 dark:divide-neutral-800",children:l.map((e,t)=>(0,r.jsxs)("li",{className:"p-3",children:[(0,r.jsxs)("div",{className:"text-xs mb-1 opacity-70",children:[e.id?(0,r.jsx)("span",{className:"font-medium",children:e.id}):(0,r.jsx)("span",{className:"font-medium",children:"NOTAM"}),e.starts||e.ends?(0,r.jsxs)("span",{className:"ml-2",children:[e.starts?"From ".concat(e.starts):"",e.starts&&e.ends?" → ":"",e.ends?"Until ".concat(e.ends):""]}):null]}),(0,r.jsx)("div",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:e.text})]},(e.id||"")+t))})]},a):null})]},t):null}),eE.has("OTHER")&&(0,r.jsxs)("section",{className:"mb-6 rounded-lg border border-neutral-200 dark:border-neutral-800",children:[(0,r.jsxs)("header",{className:"px-3 py-2 border-b border-neutral-200 dark:border-neutral-800 bg-white/60 dark:bg-neutral-900/60",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold",children:"OTHER / FIR / Misc"}),(0,r.jsxs)("p",{className:"text-xs opacity-60",children:[Array.from(eB.otherPlaces.values()).reduce((e,t)=>e+Array.from(t.values()).reduce((e,t)=>e+t.length,0),0)," ","NOTAMs"]})]}),(0,r.jsx)("div",{className:"p-3 flex flex-wrap gap-2",children:Array.from(eB.otherPlaces.entries()).map(e=>{let[t,n]=e,l=Array.from(n.values()).reduce((e,t)=>e+t.length,0),a=eP.has(t);return(0,r.jsxs)("button",{onClick:()=>eq(t),className:["text-xs px-3 py-1.5 rounded-md border transition",a?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900","border-neutral-200 dark:border-neutral-700"].join(" "),title:"".concat(l," NOTAM").concat(1!==l?"s":""),children:[t," (",l,")"]},t)})}),Array.from(eB.otherPlaces.entries()).map(e=>{let[t,n]=e;return eP.has(t)?(0,r.jsxs)("div",{className:"border-t border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)("div",{className:"px-3 py-2 bg-neutral-50/60 dark:bg-neutral-900/40",children:(0,r.jsx)("h4",{className:"text-xs font-semibold",children:t})}),(0,r.jsx)("div",{className:"p-3 flex flex-wrap gap-2",children:Array.from(n.entries()).map(e=>{let[n,l]=e,a="OTHER:".concat(t,"|").concat(n),i=eO.has(a);return(0,r.jsxs)("button",{onClick:()=>{let e=new Set(eO);e.has(a)?e.delete(a):e.add(a),eR(e)},className:["text-xs px-3 py-1.5 rounded-md border transition",i?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900","border-neutral-200 dark:border-neutral-700"].join(" "),children:[n," (",l.length,")"]},a)})}),Array.from(n.entries()).map(e=>{let[n,l]=e,a="OTHER:".concat(t,"|").concat(n);return eO.has(a)?(0,r.jsxs)("div",{className:"border-t border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)("div",{className:"px-3 py-2 bg-neutral-50/60 dark:bg-neutral-900/40",children:(0,r.jsxs)("h5",{className:"text-xs font-semibold",children:[n," ",(0,r.jsxs)("span",{className:"opacity-60 font-normal",children:["(",l.length,")"]})]})}),(0,r.jsx)("ul",{className:"divide-y divide-neutral-200 dark:divide-neutral-800",children:l.map((e,t)=>(0,r.jsxs)("li",{className:"p-3",children:[(0,r.jsxs)("div",{className:"text-xs mb-1 opacity-70",children:[e.id?(0,r.jsx)("span",{className:"font-medium",children:e.id}):(0,r.jsx)("span",{className:"font-medium",children:"NOTAM"}),e.starts||e.ends?(0,r.jsxs)("span",{className:"ml-2",children:[e.starts?"From ".concat(e.starts):"",e.starts&&e.ends?" → ":"",e.ends?"Until ".concat(e.ends):""]}):null]}),(0,r.jsx)("div",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:e.text})]},(e.id||"")+t))})]},a):null})]},t):null})]})]})]}),!1]})}),"wx"===e&&(0,r.jsxs)("div",{className:"h-full overflow-auto",children:[(0,r.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-xs opacity-60",children:"METAR & TAF"}),(0,r.jsx)("button",{onClick:()=>void e_(),className:"text-xs px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:"Refresh"})]}),$&&(0,r.jsx)("div",{className:"text-sm",children:"Loading weather…"}),et&&(0,r.jsx)("div",{className:"text-sm text-red-600",children:et}),!$&&!et&&(0,r.jsxs)("div",{className:"space-y-3",children:[(!z||0===Object.keys(z).length)&&(0,r.jsx)("div",{className:"text-sm opacity-70",children:"No stations."}),Object.entries(z||{}).map(e=>{let[t,n]=e;return(0,r.jsxs)("section",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800",children:[(0,r.jsx)("header",{className:"px-3 py-2 border-b border-neutral-200 dark:border-neutral-800 bg-white/60 dark:bg-neutral-900/60",children:(0,r.jsx)("h3",{className:"text-sm font-semibold",children:t})}),(0,r.jsxs)("div",{className:"p-3 space-y-2",children:[n.metar&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-xs opacity-60 mb-1",children:["METAR"," ",n.metarTime?"(".concat(n.metarTime,")"):""]}),(0,r.jsx)("pre",{className:"text-xs whitespace-pre-wrap leading-snug",children:n.metar})]}),n.taf&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-xs opacity-60 mb-1",children:["TAF ",n.tafTime?"(".concat(n.tafTime,")"):""]}),(0,r.jsx)("pre",{className:"text-xs whitespace-pre-wrap leading-snug",children:n.taf})]}),!n.metar&&!n.taf&&(0,r.jsx)("div",{className:"text-xs opacity-70",children:"No data."})]})]},t)})]})]}),"acars"===e&&(0,r.jsxs)("div",{className:"h-full overflow-auto",children:[(0,r.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-xs opacity-60",children:["From: ",ei||"—"," ",(null==_?void 0:_.online)?"(VATSIM)":""," \xb7 Logon:"," ",el||"Not set (Settings)"]}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)("button",{onClick:()=>ew(e=>!e),className:"text-xs px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:ey?"Close":"+ New Message"})})]}),ey&&(0,r.jsxs)("section",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800 p-3 mb-4",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold mb-2",children:"New Message"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-xs opacity-70 mb-1",children:"To (station/callsign)"}),(0,r.jsx)("input",{value:es,onChange:e=>ed(e.target.value.toUpperCase()),className:"w-full rounded-md border px-3 py-1.5 text-sm bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs opacity-70 mb-1",children:"Type"}),(0,r.jsxs)("select",{value:ef,onChange:e=>eb(e.target.value),className:"w-full rounded-md border px-3 py-1.5 text-sm bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:[(0,r.jsx)("option",{value:"telex",children:"Telex"}),(0,r.jsx)("option",{value:"cpdlc",children:"CPDLC"}),(0,r.jsx)("option",{value:"position",children:"Position"}),(0,r.jsx)("option",{value:"posreq",children:"PosReq"}),(0,r.jsx)("option",{value:"ping",children:"Ping"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mb-2",children:[(0,r.jsx)("button",{onClick:function(){eb("cpdlc"),eu(e=>e||"REQUEST CLEARANCE")},className:"text-[11px] px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:"+ Request PDC"}),(0,r.jsx)("button",{onClick:function(){eb("cpdlc"),eu("REQUEST LOGON")},className:"text-[11px] px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:"+ CPDLC Logon"}),(0,r.jsx)("button",{onClick:function(){var e,t,n,r,l;eb("position");let a=null!==(e=null==_?void 0:_.lat)&&void 0!==e?e:null,i=null!==(t=null==_?void 0:_.lon)&&void 0!==t?t:null,o=null!==(n=null==_?void 0:_.altitudeFt)&&void 0!==n?n:null,s=null!==(r=null==_?void 0:_.groundspeed)&&void 0!==r?r:null,d=null!==(l=null==_?void 0:_.headingDeg)&&void 0!==l?l:null,c=[null!=a&&null!=i&&Number.isFinite(a)&&Number.isFinite(i)?"".concat(a>=0?"N":"S").concat(Math.abs(a).toFixed(3)," ").concat(i>=0?"E":"W").concat(Math.abs(i).toFixed(3)):"N00.000 E000.000"];null!=o&&c.push("ALT ".concat(Math.round(o),"FT")),null!=s&&c.push("GS ".concat(Math.round(s))),null!=d&&c.push("HDG ".concat(Math.round(d))),eu(c.join(" "))},className:"text-[11px] px-2 py-1 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:"+ Position Report"})]}),(0,r.jsx)("label",{className:"block text-xs opacity-70 mb-1",children:"Text"}),(0,r.jsx)("textarea",{value:ec,onChange:e=>eu(e.target.value),rows:6,className:"w-full rounded-md border px-3 py-1.5 text-sm bg-white dark:bg-neutral-900 border-neutral-200 dark:border-neutral-700 mb-2"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>void eT(),disabled:em,className:"text-xs px-3 py-1.5 rounded-md border bg-white/70 dark:bg-neutral-900/40 hover:bg-white dark:hover:bg-neutral-900 border-neutral-200 dark:border-neutral-700",children:em?"Sending…":"Send"}),ep&&(0,r.jsx)("span",{className:"text-xs text-red-600",children:ep})]})]}),!ey&&(0,r.jsxs)("section",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800 p-3",children:[(0,r.jsx)("div",{className:"mb-2 flex items-center justify-between",children:(0,r.jsx)("h3",{className:"text-sm font-semibold",children:"Inbox"})}),0===ev.length&&(0,r.jsx)("div",{className:"text-xs opacity-70",children:"No messages."}),(0,r.jsx)("ul",{className:"divide-y divide-neutral-200 dark:divide-neutral-800",children:ev.slice().reverse().map((e,t)=>(0,r.jsxs)("li",{className:"py-2",children:[(0,r.jsxs)("div",{className:"text-[11px] opacity-60 font-semibold",children:["FROM: ",e.from||"-"]}),(0,r.jsx)("div",{className:"text-sm whitespace-pre-wrap mt-1",children:e.text})]},t))})]})]}),"checklists_sops"===e&&(0,r.jsx)("div",{className:"h-full overflow-auto",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto space-y-4",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold",children:"Checklists & SOPs"}),(0,r.jsxs)("ul",{className:"list-disc pl-5 text-sm opacity-80 space-y-1",children:[(0,r.jsx)("li",{children:"Normal checklists"}),(0,r.jsx)("li",{children:"Abnormals & emergencies"}),(0,r.jsx)("li",{children:"Company/crew SOP highlights"})]})]})}),o&&"psx"===e&&(0,r.jsxs)("div",{className:"h-full overflow-auto space-y-3",children:[(0,r.jsxs)("div",{className:"p-3 rounded-lg border border-neutral-200 dark:border-neutral-800 bg-white/70 dark:bg-neutral-900/40",children:[(0,r.jsx)("div",{className:"text-[10px] uppercase tracking-wide opacity-60 mb-2",children:"PSX Control"}),(0,r.jsx)("div",{className:"space-y-4 text-sm",children:(0,r.jsx)(g,{})})]}),(0,r.jsx)(S,{})]}),"audio"===e&&(0,r.jsx)("div",{className:"h-full flex items-center justify-center opacity-70",children:(0,r.jsx)("p",{children:"Audio: ATIS/TTS, briefings, or recorded calls."})})]})})})}},6015:function(e,t,n){"use strict";n.d(t,{s:function(){return l}});var r=n(7437);function l(e){let{title:t,actions:n,children:l,className:a=""}=e;return(0,r.jsxs)("section",{className:["rounded-xl border shadow-sm","bg-white text-black","dark:bg-neutral-900/70 dark:text-white","border-neutral-200 dark:border-neutral-800","min-h-0",a].join(" "),children:[(0,r.jsxs)("header",{className:"flex items-center justify-between rounded-t-xl px-3.5 py-2.5 bg-white dark:bg-neutral-800/60 border-b border-neutral-200 dark:border-neutral-800 shrink-0",children:[(0,r.jsx)("h3",{className:"text-[13px] font-semibold tracking-wide",children:t}),n]}),(0,r.jsx)("div",{className:"p-3 rounded-b-xl h-[calc(100%-2.75rem)] min-h-0 overflow-y-auto overscroll-contain touch-pan-y",children:l})]})}},5892:function(e,t,n){"use strict";n.d(t,{TwitchSidebar:function(){return c}});var r=n(7437),l=n(6015),a=n(9512),i=n(2265),o=n(357);let s=(0,i.memo)(function(e){let{channel:t="teamcovey",className:n,extraParents:l=[]}=e,{theme:s,systemTheme:d}=(0,a.F)(),[c,u]=(0,i.useState)("localhost"),[m,h]=(0,i.useState)(0),[p,x]=(0,i.useState)(!1),[f,b]=(0,i.useState)(!1),[v,g]=(0,i.useState)(!1),y=(0,i.useRef)(null),w=(0,i.useRef)(!0);(0,i.useEffect)(()=>{var e;if(null===(e=window.location)||void 0===e?void 0:e.hostname){u(window.location.hostname);let e=window.location.protocol,t=window.location.hostname;"https:"!==e&&"localhost"!==t&&"127.0.0.1"!==t&&g(!0)}},[]),(0,i.useEffect)(()=>{let e=window.location.protocol,t=window.location.hostname,n=window.location.port?":".concat(window.location.port):"",r=/^\d{1,3}(?:\.\d{1,3}){3}$/.test(t);if("https:"===e&&r&&!t.endsWith(".nip.io")){let r="".concat(e,"//").concat(t,".nip.io").concat(n).concat(window.location.pathname).concat(window.location.search).concat(window.location.hash);window.location.replace(r)}},[]),(0,i.useEffect)(()=>{if(v||f||p){y.current&&(clearTimeout(y.current),y.current=null);return}return y.current||(y.current=setTimeout(()=>b(!0),6e3)),()=>{y.current&&(clearTimeout(y.current),y.current=null)}},[v,f,p]);let N="dark"===("system"===s?d:s);(0,i.useEffect)(()=>{if(w.current){w.current=!1;return}h(e=>e+1)},[N]);let j=(0,i.useMemo)(()=>{let e=c.split(":")[0]||c,n=/^\d{1,3}(?:\.\d{1,3}){3}$/.test(e),r=n?"".concat(e,".nip.io"):null,a="https://www.twitch.tv/embed/".concat(encodeURIComponent(t),"/chat"),i=[e,c,r,n?e:null,"localhost","127.0.0.1",...(o.env.NEXT_PUBLIC_TWITCH_PARENTS||"").split(/[\,\s]+/).map(e=>e.trim()).filter(Boolean)||[],...l].map(e=>(e||"").replace(/^https?:\/\//,"")).filter(Boolean),s=new URLSearchParams;return i.forEach(e=>s.append("parent",e)),N?s.set("darkpopout","true"):s.set("theme","light"),s.set("v",String(m)),"".concat(a,"?").concat(s.toString())},[t,c,l,N,m]);return(0,r.jsxs)("div",{className:"relative h-full w-full",children:[!v&&(0,r.jsx)("iframe",{src:j,title:"Twitch Chat",className:null!=n?n:"",frameBorder:0,scrolling:"no",allow:"autoplay; clipboard-write; encrypted-media; fullscreen",allowFullScreen:!0,onLoad:()=>{x(!0),b(!1),y.current&&(clearTimeout(y.current),y.current=null)},onError:()=>{b(!0),x(!1)}},"".concat(t,"-").concat(N?"dark":"light","-").concat(c,"-").concat(m)),(v||f)&&(0,r.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-black/70 text-white text-sm px-4 text-center",children:[(0,r.jsx)("p",{className:"font-semibold",children:"Twitch chat is blocked on this connection."}),(0,r.jsxs)("div",{className:"text-xs opacity-80 space-y-2",children:[(0,r.jsx)("p",{children:"Twitch requires HTTPS for non-localhost embeds."}),(0,r.jsxs)("p",{children:["Try: ",(0,r.jsxs)("code",{className:"px-1 py-0.5 bg-white/10 rounded",children:["https://",c.split(":")[0],".nip.io:3000"]})]})]}),(0,r.jsx)("a",{href:"https://www.twitch.tv/popout/".concat(encodeURIComponent(t),"/chat?popout="),target:"_blank",rel:"noreferrer noopener",className:"px-3 py-1.5 rounded-md bg-white text-black text-xs font-semibold",children:"Open chat in new window"})]})]})});function d(){return(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"text-xs rounded-md border px-2 py-1   bg-white/70 dark:bg-neutral-900/40   border-neutral-200 dark:border-neutral-700   hover:bg-white dark:hover:bg-neutral-900",children:"Reload"})}let c=i.memo(function(){return(0,r.jsx)("aside",{className:"hidden md:block col-span-1 h-full min-h-0",children:(0,r.jsx)(l.s,{title:"Twitch Chat",actions:(0,r.jsx)(d,{}),className:"h-full min-h-0",children:(0,r.jsx)("div",{className:"h-full rounded-lg overflow-hidden bg-neutral-50 dark:bg-neutral-900",children:(0,r.jsx)(s,{channel:"teamcovey",className:"w-full h-full"})})})})})},5450:function(e,t,n){"use strict";n.d(t,{Kp:function(){return u},Vg:function(){return c},lo:function(){return d},ri:function(){return i},t3:function(){return m},wj:function(){return o}});let r="dispatch.settings.v1",l="covey_vatsim_cid",a="covey_simbrief_username";function i(){var e,t,n;let i=null!==(n=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(localStorage.getItem(r)))&&void 0!==n?n:{},o=null===(e=localStorage.getItem(l))||void 0===e?void 0:e.trim();!i.vatsimCid&&o&&(i.vatsimCid=o,localStorage.setItem(r,JSON.stringify(i)));let s=null===(t=localStorage.getItem(a))||void 0===t?void 0:t.trim();return!i.simbriefUsername&&s&&(i.simbriefUsername=s,localStorage.setItem(r,JSON.stringify(i))),i}let o="settings:updated";function s(e){var t,n;let s={...i(),...e};if(localStorage.setItem(r,JSON.stringify(s)),window.dispatchEvent(new Event(o)),"vatsimCid"in e){let n=null===(t=e.vatsimCid)||void 0===t?void 0:t.trim();n?localStorage.setItem(l,n):localStorage.removeItem(l)}if("simbriefUsername"in e){let t=null===(n=e.simbriefUsername)||void 0===n?void 0:n.trim();t&&localStorage.setItem(a,t)}}let d=e=>s({vatsimCid:(null==e?void 0:e.trim())||void 0}),c=e=>s({simbriefUsername:(null==e?void 0:e.trim())||void 0}),u=e=>s({hoppieLogon:(null==e?void 0:e.trim())||void 0}),m=e=>s({psxEnabled:!!e})},357:function(e,t,n){"use strict";var r,l;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(l=n.g.process)?void 0:l.env)?n.g.process:n(8081)},8081:function(e){!function(){var t={229:function(e){var t,n,r,l=e.exports={};function a(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var s=[],d=!1,c=-1;function u(){d&&r&&(d=!1,r.length?s=r.concat(s):c=-1,s.length&&m())}function m(){if(!d){var e=o(u);d=!0;for(var t=s.length;t;){for(r=s,s=[];++c<t;)r&&r[c].run();c=-1,t=s.length}r=null,d=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}l.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new h(e,t)),1!==s.length||d||o(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=p,l.addListener=p,l.once=p,l.off=p,l.removeListener=p,l.removeAllListeners=p,l.emit=p,l.prependListener=p,l.prependOnceListener=p,l.listeners=function(e){return[]},l.binding=function(e){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw Error("process.chdir is not supported")},l.umask=function(){return 0}}},n={};function r(e){var l=n[e];if(void 0!==l)return l.exports;var a=n[e]={exports:{}},i=!0;try{t[e](a,a.exports,r),i=!1}finally{i&&delete n[e]}return a.exports}r.ab="//";var l=r(229);e.exports=l}()},9512:function(e,t,n){"use strict";n.d(t,{F:function(){return c},f:function(){return u}});var r=n(2265),l=(e,t,n,r,l,a,i,o)=>{let s=document.documentElement,d=["light","dark"];function c(t){(Array.isArray(e)?e:[e]).forEach(e=>{let n="class"===e,r=n&&a?l.map(e=>a[e]||e):l;n?(s.classList.remove(...r),s.classList.add(a&&a[t]?a[t]:t)):s.setAttribute(e,t)}),o&&d.includes(t)&&(s.style.colorScheme=t)}if(r)c(r);else try{let e=localStorage.getItem(t)||n,r=i&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(r)}catch(e){}},a=["light","dark"],i="(prefers-color-scheme: dark)",o="undefined"==typeof window,s=r.createContext(void 0),d={setTheme:e=>{},themes:[]},c=()=>{var e;return null!=(e=r.useContext(s))?e:d},u=e=>r.useContext(s)?r.createElement(r.Fragment,null,e.children):r.createElement(h,{...e}),m=["light","dark"],h=e=>{let{forcedTheme:t,disableTransitionOnChange:n=!1,enableSystem:l=!0,enableColorScheme:o=!0,storageKey:d="theme",themes:c=m,defaultTheme:u=l?"system":"light",attribute:h="data-theme",value:v,children:g,nonce:y,scriptProps:w}=e,[N,j]=r.useState(()=>x(d,u)),[k,S]=r.useState(()=>"system"===N?b():N),T=v?Object.values(v):c,C=r.useCallback(e=>{let t=e;if(!t)return;"system"===e&&l&&(t=b());let r=v?v[t]:t,i=n?f(y):null,s=document.documentElement,d=e=>{"class"===e?(s.classList.remove(...T),r&&s.classList.add(r)):e.startsWith("data-")&&(r?s.setAttribute(e,r):s.removeAttribute(e))};if(Array.isArray(h)?h.forEach(d):d(h),o){let e=a.includes(u)?u:null,n=a.includes(t)?t:e;s.style.colorScheme=n}null==i||i()},[y]),E=r.useCallback(e=>{let t="function"==typeof e?e(N):e;j(t);try{localStorage.setItem(d,t)}catch(e){}},[N]),A=r.useCallback(e=>{S(b(e)),"system"===N&&l&&!t&&C("system")},[N,t]);r.useEffect(()=>{let e=window.matchMedia(i);return e.addListener(A),A(e),()=>e.removeListener(A)},[A]),r.useEffect(()=>{let e=e=>{e.key===d&&(e.newValue?j(e.newValue):E(u))};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[E]),r.useEffect(()=>{C(null!=t?t:N)},[t,N]);let O=r.useMemo(()=>({theme:N,setTheme:E,forcedTheme:t,resolvedTheme:"system"===N?k:N,themes:l?[...c,"system"]:c,systemTheme:l?k:void 0}),[N,E,t,k,l,c]);return r.createElement(s.Provider,{value:O},r.createElement(p,{forcedTheme:t,storageKey:d,attribute:h,enableSystem:l,enableColorScheme:o,defaultTheme:u,value:v,themes:c,nonce:y,scriptProps:w}),g)},p=r.memo(e=>{let{forcedTheme:t,storageKey:n,attribute:a,enableSystem:i,enableColorScheme:o,defaultTheme:s,value:d,themes:c,nonce:u,scriptProps:m}=e,h=JSON.stringify([a,n,s,t,c,d,i,o]).slice(1,-1);return r.createElement("script",{...m,suppressHydrationWarning:!0,nonce:"undefined"==typeof window?u:"",dangerouslySetInnerHTML:{__html:"(".concat(l.toString(),")(").concat(h,")")}})}),x=(e,t)=>{let n;if(!o){try{n=localStorage.getItem(e)||void 0}catch(e){}return n||t}},f=e=>{let t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},b=e=>(e||(e=window.matchMedia(i)),e.matches?"dark":"light")}},function(e){e.O(0,[971,23,744],function(){return e(e.s=317)}),_N_E=e.O()}]);